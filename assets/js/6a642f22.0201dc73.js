(self.webpackChunkjoyce_docs=self.webpackChunkjoyce_docs||[]).push([[244],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return l},kt:function(){return d}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),c=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},l=function(e){var t=c(e.components);return r.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),m=c(n),d=a,h=m["".concat(p,".").concat(d)]||m[d]||u[d]||o;return n?r.createElement(h,i(i({ref:t},l),{},{components:n})):r.createElement(h,i({ref:t},l))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=m;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var c=2;c<o;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},4414:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return i},metadata:function(){return s},toc:function(){return p},default:function(){return l}});var r=n(2122),a=n(9756),o=(n(7294),n(3905)),i={},s={unversionedId:"rest",id:"rest",isDocsHomePage:!1,title:"Joyce API",description:"joyce-rest is the main interface to consume the final output of Joyce transofrmations.",source:"@site/docs/60-rest.md",sourceDirName:".",slug:"/rest",permalink:"/joyce/docs/rest",editUrl:"https://github.com/sourcesense/joyce/edit/main/docs/docs/60-rest.md",version:"current",sidebarPosition:60,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Mongodb Sink",permalink:"/joyce/docs/sink"},next:{title:"Event Messaging",permalink:"/joyce/docs/event-messaging"}},p=[{value:"Configuration",id:"configuration",children:[]},{value:"REST",id:"rest",children:[]},{value:"JSON-RPC",id:"json-rpc",children:[]},{value:"GraphQL",id:"graphql",children:[]}],c={toc:p};function l(e){var t=e.components,n=(0,a.Z)(e,["components"]);return(0,o.kt)("wrapper",(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"joyce-rest")," is the main interface to consume the final output of Joyce transofrmations.",(0,o.kt)("br",{parentName:"p"}),"\n","It expose a ",(0,o.kt)("strong",{parentName:"p"},"REST")," and a ",(0,o.kt)("strong",{parentName:"p"},"GraphQL")," interface to ",(0,o.kt)("em",{parentName:"p"},"read")," and a ",(0,o.kt)("strong",{parentName:"p"},"JSON-RPC")," interface to propagate other operations to the source backend systems."),(0,o.kt)("h2",{id:"configuration"},"Configuration"),(0,o.kt)("p",null,"The api needs a json config file that defines which schemas to serve, this enables you to spawn different instances of the api if you want to serve different content to different endpoints."),(0,o.kt)("p",null,"The configuration file is really simple:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{   \n    "schemas": {\n        "[PATH]": {\n            "source": "[JOYCE_URI_OF_SCHEMA]"\n        }\n    }\n}\n')),(0,o.kt)("p",null,"ie."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{   \n    "schemas": {\n        "users": {\n            "source": "http://import-gateway:6651/api/schema/user"\n        },\n        "projects": {\n            "source": "http://import-gateway:6651/api/schema/project"\n        }\n    }\n}\n')),(0,o.kt)("p",null,"The file is read at startup so you have to already have the schema stored within the import gateway."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"joyce-rest")," read the schema and parses its ",(0,o.kt)("a",{parentName:"p",href:"schema#$metadata"},"$metadata"),", knowing the shape of the content, the collection and unique id of content."),(0,o.kt)("h2",{id:"rest"},"REST"),(0,o.kt)("p",null,"With this information it will expose a Swagger documentation of the API at ",(0,o.kt)("inlineCode",{parentName:"p"},"/docs"),"."),(0,o.kt)("p",null,"For every schema configured two enpoint are exposed:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"one to retrive a single content by uid ",(0,o.kt)("inlineCode",{parentName:"li"},"/[PATH]/[UID]")),(0,o.kt)("li",{parentName:"ul"},"one to list content  ",(0,o.kt)("inlineCode",{parentName:"li"},"/[PATH]")," that can be ",(0,o.kt)("em",{parentName:"li"},"paged"),", ",(0,o.kt)("em",{parentName:"li"},"ordered")," and ",(0,o.kt)("em",{parentName:"li"},"filtered"))),(0,o.kt)("h2",{id:"json-rpc"},"JSON-RPC"),(0,o.kt)("p",null,"API are ",(0,o.kt)("strong",{parentName:"p"},"read-only"),", only GET endpoint are exposed for the collections, but the platform enables also a way to push back writes, but following a CQRS approach does it in a different way."),(0,o.kt)("p",null,"There is a ",(0,o.kt)("inlineCode",{parentName:"p"},"/jrpc")," endpoint where you can send ",(0,o.kt)("a",{parentName:"p",href:"https://www.jsonrpc.org/specification"},"json-rpc")," messages that will be published on a ",(0,o.kt)("inlineCode",{parentName:"p"},"joyce_command")," topic, that you can consume with custom code to make changes to the backend systems that owns the row data."),(0,o.kt)("h2",{id:"graphql"},"GraphQL"),(0,o.kt)("p",null,"This service will expose also a ",(0,o.kt)("a",{parentName:"p",href:"https://graphql.org/"},"GraphQL")," interface at ",(0,o.kt)("inlineCode",{parentName:"p"},"/query")," and a playground at ",(0,o.kt)("inlineCode",{parentName:"p"},"/graphql"),".\nThe schema is transposed to a graphql schema automatically by using ",(0,o.kt)("a",{parentName:"p",href:"https://www.graphql-mesh.com/"},"GraphQL Mesh")))}l.isMDXComponent=!0}}]);